<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#1a1a2e">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>TikTakToo</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.2/font/bootstrap-icons.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="app">
        <!-- Login/Register Screen -->
        <div id="authScreen" class="screen active">
            <div class="auth-container">
                <h1>TikTakToo</h1>
                <div class="auth-tabs">
                    <button class="tab-btn active" onclick="showLogin()">Login</button>
                    <button class="tab-btn" onclick="showRegister()">Register</button>
                </div>
                
                <form id="loginForm" class="auth-form">
                    <input type="text" id="loginUsername" placeholder="Username" required autocomplete="username" aria-label="Username">
                    <input type="password" id="loginPassword" placeholder="Password" required autocomplete="current-password" aria-label="Password">
                    <button type="submit" aria-label="Login to game">Login</button>
                </form>
                
                <form id="registerForm" class="auth-form hidden">
                    <input type="text" id="registerUsername" placeholder="Username" required autocomplete="username" aria-label="Choose username">
                    <input type="password" id="registerPassword" placeholder="Password" required autocomplete="new-password" aria-label="Choose password">
                    <button type="submit" aria-label="Create new account">Register</button>
                </form>
            </div>
        </div>

        <!-- Lobby Screen -->
        <div id="lobbyScreen" class="screen">
            <div class="lobby-container">
                <!-- Header -->
                <header class="lobby-header">
                    <h1>TikTakToo</h1>
                    <div class="user-controls">
                        <button id="userProfile" onclick="showProfile()"></button>
                        <button onclick="logout()" class="logout-btn">Logout</button>
                    </div>
                </header>

                <!-- Main Content Layout -->
                <div class="lobby-layout">
                    <!-- Main Content Area -->
                    <main class="main-content">
                        <section class="dashboard-section">
                            <h2 class="section-title">
                                <i class="bi bi-speedometer2 section-icon"></i>
                                Dashboard
                            </h2>
                            <div class="dashboard-grid">
                                <div class="dashboard-card quick-match-card">
                                    <h3>Quick Match</h3>
                                    <p>Find a random opponent</p>
                                    <button id="findMatchBtn" class="find-match-btn" onclick="findMatch()">Find Match</button>
                                </div>
                                <div class="dashboard-card stats-card">
                                    <h3>Your Stats</h3>
                                    <div class="stats-overview">
                                        <div class="stat-item">
                                            <span class="stat-number" id="userWins">0</span>
                                            <span class="stat-label">Wins</span>
                                        </div>
                                        <div class="stat-item">
                                            <span class="stat-number" id="userLosses">0</span>
                                            <span class="stat-label">Losses</span>
                                        </div>
                                        <div class="stat-item">
                                            <span class="stat-number" id="userDraws">0</span>
                                            <span class="stat-label">Draws</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </section>
                    </main>

                    <!-- Right Sidebar -->
                    <aside class="sidebar">
                        <!-- Online Players Section -->
                        <section class="sidebar-section players-section">
                            <h3 class="sidebar-title">
                                <i class="bi bi-people-fill sidebar-icon"></i>
                                Online Players
                            </h3>
                            <div class="sidebar-content">
                                <div id="onlinePlayersList" class="players-list"></div>
                            </div>
                        </section>

                        <!-- Leaderboard Section -->
                        <section class="sidebar-section leaderboard-section">
                            <h3 class="sidebar-title">
                                <i class="bi bi-trophy-fill sidebar-icon"></i>
                                Leaderboard
                            </h3>
                            <div class="sidebar-content">
                                <div id="leaderboard" class="leaderboard"></div>
                            </div>
                        </section>
                    </aside>
                </div>

                <!-- Footer -->
                <footer class="lobby-footer">
                    <div class="footer-content">
                        <p>&copy; 2024 TikTakToo. All rights reserved.</p>
                        <div class="footer-links">
                            <span>Made with ‚ù§Ô∏è for gaming</span>
                        </div>
                    </div>
                </footer>
            </div>
        </div>

        <!-- Rock Paper Scissors Screen -->
        <div id="rpsScreen" class="screen">
            <div class="rps-container">
                <div class="rps-header">
                    <h2>Rock Paper Scissors</h2>
                    <p id="rpsStatus">Choose your move!</p>
                </div>
                <div class="rps-choices">
                    <button class="rps-btn" data-choice="rock" onclick="makeRPSChoice('rock')">
                        <i class="bi bi-gem rps-icon"></i>
                        <span>Rock</span>
                    </button>
                    <button class="rps-btn" data-choice="paper" onclick="makeRPSChoice('paper')">
                        <i class="bi bi-file-earmark rps-icon"></i>
                        <span>Paper</span>
                    </button>
                    <button class="rps-btn" data-choice="scissors" onclick="makeRPSChoice('scissors')">
                        <i class="bi bi-scissors rps-icon"></i>
                        <span>Scissors</span>
                    </button>
                </div>
                <button onclick="leaveRPS()" class="leave-btn">Leave Game</button>
            </div>
        </div>

        <!-- Game Screen -->
        <div id="gameScreen" class="screen">
            <div class="game-container">
                <div class="game-header">
                    <div class="game-info">
                        <span id="gameStatus"></span>
                    </div>
                    <div class="game-actions">
                        <button id="rematchBtn" onclick="requestRematch()" style="display:none">Rematch</button>
                        <button onclick="leaveGame()">Leave Game</button>
                    </div>
                </div>
                
                <div class="game-board-container">
                    <div id="gameBoard" class="game-board"></div>
                    
                    <div class="chat-container">
                        <div id="chatMessages" class="chat-messages"></div>
                        <div class="chat-input">
                            <input type="text" id="messageInput" placeholder="Type a message..." aria-label="Chat message" autocomplete="off">
                            <button onclick="toggleEmotePicker()" class="emote-btn" aria-label="Add emote"><i class="bi bi-emoji-smile"></i></button>
                            <button onclick="sendMessage()" aria-label="Send message">Send</button>
                        </div>
                        <div id="emotePicker" class="emote-picker hidden">
                            <div class="emote-grid">
                                <i class="bi bi-emoji-smile" onclick="addEmote('üòÄ')"></i>
                                <i class="bi bi-emoji-laughing" onclick="addEmote('üòÇ')"></i>
                                <i class="bi bi-emoji-sunglasses" onclick="addEmote('üòé')"></i>
                                <i class="bi bi-emoji-heart-eyes" onclick="addEmote('üòç')"></i>
                                <i class="bi bi-emoji-thinking" onclick="addEmote('ü§î')"></i>
                                <i class="bi bi-emoji-frown" onclick="addEmote('üò≠')"></i>
                                <i class="bi bi-emoji-angry" onclick="addEmote('üò°')"></i>
                                <i class="bi bi-hand-thumbs-up" onclick="addEmote('üëç')"></i>
                                <i class="bi bi-hand-thumbs-down" onclick="addEmote('üëé')"></i>
                                <i class="bi bi-heart-fill" onclick="addEmote('‚ù§Ô∏è')"></i>
                                <i class="bi bi-fire" onclick="addEmote('üî•')"></i>
                                <i class="bi bi-star-fill" onclick="addEmote('‚≠ê')"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Challenge Modal -->
        <div id="challengeModal" class="modal">
            <div class="modal-content">
                <h3>Choose Your Symbol</h3>
                <div class="symbol-choice">
                    <button onclick="sendChallenge('X')" aria-label="Choose X symbol">X</button>
                    <button onclick="sendChallenge('O')" aria-label="Choose O symbol">O</button>
                    <button onclick="sendChallenge('‚≠ê')" aria-label="Choose star symbol">‚≠ê</button>
                    <button onclick="sendChallenge('üî•')" aria-label="Choose fire symbol">üî•</button>
                    <button onclick="sendChallenge('‚ö°')" aria-label="Choose lightning symbol">‚ö°</button>
                    <button onclick="sendChallenge('üíé')" aria-label="Choose diamond symbol">üíé</button>
                    <button onclick="sendChallenge('fun')" aria-label="Choose fun symbol" class="image-symbol"><img src="images/fun.jpg" alt="Fun"></button>
                    <button onclick="sendChallenge('giga')" aria-label="Choose giga symbol" class="image-symbol"><img src="images/giga.jpg" alt="Giga"></button>
                    <button onclick="sendChallenge('kupal')" aria-label="Choose kupal symbol" class="image-symbol"><img src="images/kupal.jpg" alt="Kupal"></button>
                    <button onclick="sendChallenge('lol')" aria-label="Choose lol symbol" class="image-symbol"><img src="images/lol.jpg" alt="Lol"></button>
                    <button onclick="sendChallenge('suck')" aria-label="Choose suck symbol" class="image-symbol"><img src="images/suck.jpg" alt="Suck"></button>
                    <button onclick="sendChallenge('troll')" aria-label="Choose troll symbol" class="image-symbol"><img src="images/troll.jpg" alt="Troll"></button>
                    <button onclick="sendChallenge('isu')" aria-label="Choose ISU symbol" class="image-symbol"><img src="images/isu.jpg" alt="ISU"></button>
                    <button onclick="sendChallenge('ccsict')" aria-label="Choose CCSICT symbol" class="image-symbol"><img src="images/ccsict.jpg" alt="CCSICT"></button>
                </div>
            </div>
        </div>

        <!-- Avatar Selection Modal -->
        <div id="avatarModal" class="modal">
            <div class="modal-content">
                <h3>Choose Avatar</h3>
                <div class="avatar-grid">
                    <div class="avatar-option" onclick="selectAvatar('controller')" data-avatar="controller"><i class="bi bi-controller"></i></div>
                    <div class="avatar-option" onclick="selectAvatar('bullseye')" data-avatar="bullseye"><i class="bi bi-bullseye"></i></div>
                    <div class="avatar-option" onclick="selectAvatar('dice')" data-avatar="dice"><i class="bi bi-dice-6"></i></div>
                    <div class="avatar-option" onclick="selectAvatar('trophy')" data-avatar="trophy"><i class="bi bi-trophy"></i></div>
                    <div class="avatar-option" onclick="selectAvatar('star')" data-avatar="star"><i class="bi bi-star-fill"></i></div>
                    <div class="avatar-option" onclick="selectAvatar('fire')" data-avatar="fire"><i class="bi bi-fire"></i></div>
                    <div class="avatar-option" onclick="selectAvatar('lightning')" data-avatar="lightning"><i class="bi bi-lightning-fill"></i></div>
                    <div class="avatar-option" onclick="selectAvatar('gem')" data-avatar="gem"><i class="bi bi-gem"></i></div>
                </div>
            </div>
        </div>

        <!-- Rematch Request Modal -->
        <div id="rematchRequestModal" class="modal">
            <div class="modal-content">
                <h3 id="rematchRequestText"></h3>
                <div class="challenge-actions">
                    <button onclick="respondToRematch(true)" aria-label="Accept rematch">Accept</button>
                    <button onclick="respondToRematch(false)" aria-label="Decline rematch">Decline</button>
                </div>
            </div>
        </div>

        <!-- Challenge Received Modal -->
        <div id="challengeReceivedModal" class="modal">
            <div class="modal-content">
                <h3 id="challengeText"></h3>
                <div id="challengeSymbolChoice" class="symbol-choice" style="display:none;">
                    <button onclick="acceptChallengeWithSymbol('X')" aria-label="Choose X symbol">X</button>
                    <button onclick="acceptChallengeWithSymbol('O')" aria-label="Choose O symbol">O</button>
                    <button onclick="acceptChallengeWithSymbol('‚≠ê')" aria-label="Choose star symbol">‚≠ê</button>
                    <button onclick="acceptChallengeWithSymbol('üî•')" aria-label="Choose fire symbol">üî•</button>
                    <button onclick="acceptChallengeWithSymbol('‚ö°')" aria-label="Choose lightning symbol">‚ö°</button>
                    <button onclick="acceptChallengeWithSymbol('üíé')" aria-label="Choose diamond symbol">üíé</button>
                    <button onclick="acceptChallengeWithSymbol('fun')" aria-label="Choose fun symbol" class="image-symbol"><img src="images/fun.jpg" alt="Fun"></button>
                    <button onclick="acceptChallengeWithSymbol('giga')" aria-label="Choose giga symbol" class="image-symbol"><img src="images/giga.jpg" alt="Giga"></button>
                    <button onclick="acceptChallengeWithSymbol('kupal')" aria-label="Choose kupal symbol" class="image-symbol"><img src="images/kupal.jpg" alt="Kupal"></button>
                    <button onclick="acceptChallengeWithSymbol('lol')" aria-label="Choose lol symbol" class="image-symbol"><img src="images/lol.jpg" alt="Lol"></button>
                    <button onclick="acceptChallengeWithSymbol('suck')" aria-label="Choose suck symbol" class="image-symbol"><img src="images/suck.jpg" alt="Suck"></button>
                    <button onclick="acceptChallengeWithSymbol('troll')" aria-label="Choose troll symbol" class="image-symbol"><img src="images/troll.jpg" alt="Troll"></button>
                    <button onclick="acceptChallengeWithSymbol('isu')" aria-label="Choose ISU symbol" class="image-symbol"><img src="images/isu.jpg" alt="ISU"></button>
                    <button onclick="acceptChallengeWithSymbol('ccsict')" aria-label="Choose CCSICT symbol" class="image-symbol"><img src="images/ccsict.jpg" alt="CCSICT"></button>
                </div>
                <div id="challengeInitialActions" class="challenge-actions">
                    <button onclick="showSymbolChoice()" aria-label="Accept challenge">Accept</button>
                    <button onclick="respondToChallenge(false)" aria-label="Decline challenge">Decline</button>
                </div>
            </div>
        </div>

        <!-- Match Symbol Selection Modal -->
        <div id="matchSymbolModal" class="modal">
            <div class="modal-content">
                <h3 id="matchText"></h3>
                <div class="symbol-choice" style="display:grid;">
                    <button onclick="chooseMatchSymbol('X')" aria-label="Choose X symbol">X</button>
                    <button onclick="chooseMatchSymbol('O')" aria-label="Choose O symbol">O</button>
                    <button onclick="chooseMatchSymbol('‚≠ê')" aria-label="Choose star symbol">‚≠ê</button>
                    <button onclick="chooseMatchSymbol('üî•')" aria-label="Choose fire symbol">üî•</button>
                    <button onclick="chooseMatchSymbol('‚ö°')" aria-label="Choose lightning symbol">‚ö°</button>
                    <button onclick="chooseMatchSymbol('üíé')" aria-label="Choose diamond symbol">üíé</button>
                    <button onclick="chooseMatchSymbol('fun')" aria-label="Choose fun symbol" class="image-symbol"><img src="images/fun.jpg" alt="Fun"></button>
                    <button onclick="chooseMatchSymbol('giga')" aria-label="Choose giga symbol" class="image-symbol"><img src="images/giga.jpg" alt="Giga"></button>
                    <button onclick="chooseMatchSymbol('kupal')" aria-label="Choose kupal symbol" class="image-symbol"><img src="images/kupal.jpg" alt="Kupal"></button>
                    <button onclick="chooseMatchSymbol('lol')" aria-label="Choose lol symbol" class="image-symbol"><img src="images/lol.jpg" alt="Lol"></button>
                    <button onclick="chooseMatchSymbol('suck')" aria-label="Choose suck symbol" class="image-symbol"><img src="images/suck.jpg" alt="Suck"></button>
                    <button onclick="chooseMatchSymbol('troll')" aria-label="Choose troll symbol" class="image-symbol"><img src="images/troll.jpg" alt="Troll"></button>
                    <button onclick="chooseMatchSymbol('isu')" aria-label="Choose ISU symbol" class="image-symbol"><img src="images/isu.jpg" alt="ISU"></button>
                    <button onclick="chooseMatchSymbol('ccsict')" aria-label="Choose CCSICT symbol" class="image-symbol"><img src="images/ccsict.jpg" alt="CCSICT"></button>
                </div>
            </div>
        </div>

        <!-- Profile Modal -->
        <div id="profileModal" class="modal">
            <div class="modal-content profile-modal">
                <div class="modal-header">
                    <h3>Player Profile</h3>
                    <button class="close-btn" onclick="closeProfile()">&times;</button>
                </div>
                <div class="profile-content">
                    <div class="profile-info">
                        <h4 id="profileUsername"></h4>
                        <div class="profile-stats">
                            <div class="stat">
                                <span class="stat-label">Wins</span>
                                <span id="profileWins" class="stat-value"></span>
                            </div>
                            <div class="stat">
                                <span class="stat-label">Losses</span>
                                <span id="profileLosses" class="stat-value"></span>
                            </div>
                            <div class="stat">
                                <span class="stat-label">Draws</span>
                                <span id="profileDraws" class="stat-value"></span>
                            </div>
                            <div class="stat">
                                <span class="stat-label">Win Rate</span>
                                <span id="profileWinRate" class="stat-value"></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script src="script.js"></script>
</body>
</html>